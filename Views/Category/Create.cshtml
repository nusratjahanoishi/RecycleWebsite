@model NextUses.Models.ViewModel.CategoryView;


@{
    ViewData["Title"] = " Category Add and List";
    Layout = "_BackendLayout";
    int Sl = 1;
}

<div class="content-body">
    <div class="container-fluid">

        <!-- Breadcrumb -->
        <div class="page-titles">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="javascript:void(0)">Home</a></li>
                <li class="breadcrumb-item active"><a href="javascript:void(0)">Category</a></li>
            </ol>
        </div>

        <!-- Row: Form + List -->
        <div class="row">

            <!-- Left 6 cols: Category Form -->
            <div class="col-xl-4 col-xxl-4">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">Add / Edit Category</h4>
                    </div>
                    <div class="card-body">
                        <form asp-controller="Category" asp-action="Create" method="post" enctype="multipart/form-data">
                            <!-- Category Name -->
                            <div class="mb-3">
                                <label asp-for="Category.Name" class="form-label">Category Name</label>
                                <input asp-for="Category.Name" class="form-control" />
                                <span asp-validation-for="Category.Name" class="text-danger"></span>
                            </div>

                            <!-- Description -->
                            <div class="mb-3">
                                <label asp-for="Category.Description" class="form-label">Description</label>
                                <textarea asp-for="Category.Description" class="form-control" rows="6"></textarea>
                                <span asp-validation-for="Category.Description" class="text-danger"></span>
                            </div>

                            <!-- Image -->
                            <div class="mb-3">
                                <label asp-for="Category.ImageFile" class="form-label">Category Image</label>
                                <input asp-for="Category.ImageFile" class="form-control" type="file" />
                                <span asp-validation-for="Category.ImageFile" class="text-danger"></span>
                            </div>

                            <!-- Submit -->
                            <div class="mt-3">
                                <button type="submit" class="btn btn-primary">Save Category</button>
                                <a asp-controller="Category" asp-action="Index" class="btn btn-secondary ms-2">Cancel</a>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
            

            <!-- Right 6 cols: Category List -->
            <div class="col-xl-8 col-xxl-8">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">Category List</h4>
                    </div>
                    <div class="card-body">
                        <table class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>SL</th>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Image</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                 @if (Model.Categories != null && Model.Categories.Any())
    {
                                @foreach (var item in Model.Categories)
                                    {
                                    <tr>
                                        <td>@Sl</td> 
                                        <td>@item.Name</td>
                                        <td>
                                            @((item.Description != null && item.Description.Length > 10)
                                                ? item.Description.Substring(0, 10) + "..."
                                                : item.Description)
                                        </td>

                                        <td>
                                            @if (item.Image != null)
                                            {
                                                <img src="data:image/png;base64,@Convert.ToBase64String(item.Image)" width="60" />
                                            }
                                        </td>
                                        <td>
                                            <div class="btn-group" role="group" aria-label="Actions">
                                                <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-warning">
                                                    <i class="fa fa-edit"></i> 
                                                </a>
                                                <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-danger"
                                                   onclick="return confirm('Are you sure you want to delete this item?');">
                                                    <i class="fa fa-trash"></i>
                                                </a>
                                            </div>
                                        </td>

                                    </tr>
                                    Sl++;
                                }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="2" class="text-center text-danger">No categories found</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div> <!-- End Row -->

    </div> <!-- End Container -->
</div> <!-- End Content Body -->
